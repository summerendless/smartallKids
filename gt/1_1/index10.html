<html>

<head>
    <title>스마트올 키즈</title>

    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <!-- 검색 엔진에 의해 검색되는 단어를 지정합니다. -->
    <meta name="KeyWORDs" content="" />
    <!-- 검색 결과에 표시되는 문자를 지정합니다. -->
    <meta name="Description" content="" />
    <!-- 검색 로봇 제어 -->
    <meta name="Robots" content="all" />
    <!-- 홈페이지 주제를 지정 -->
    <meta http-equiv="Subject" content="" />
    <!-- 제목을 지정 -->
    <meta http-equiv="Title" content="" />
    <!-- 페이지를 작성한 제작자명을 지정 -->
    <meta http-equiv="Author" content="onflou " />
    <!-- 제작사를 지정 -->
    <meta http-equiv="Publisher" content="" />

    <!-- 브라우저 호환성을 지정 -->
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chorme=1">
    <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

    <link rel="stylesheet" href="../../../COMM/CSS/COMMON.CSS" />
    <link rel="stylesheet" href="../../../COMM/CSS/JQUERY_UI.CSS" />
    <link rel="stylesheet" href="../../../COMM/CSS/STYLE.CSS" />
</head>

<body>
    <div id="wrap" class="">
        <!-- <div class="sectionIntro"><img src="../../COMM/IMG/INTRO.PNG" /></div> -->
        <header>
            <div class="indicate">
                <ul class="paging">
                    <li class="page off"><img src="../../COMM/IMG/ICON_CANDY_OFF.PNG"/></li>
                    <li class="page off"><img src="../../COMM/IMG/ICON_CANDY_OFF.PNG"/></li>
                    <li class="page off"><img src="../../COMM/IMG/ICON_CANDY_OFF.PNG"/></li>
                    <li class="page off"><img src="../../COMM/IMG/ICON_CANDY_OFF.PNG"/></li>
                </ul>
            </div>
        </header>

        <div class="wrapper ">
            <div class="inner inner1">
                <section class="section section1">
                    <div class="pageContents">
                        <div class="item-img"><img src="../../COMM/IMG/WORD/1_1/ITEM_1_1.png"/></div>
                        <div id="canvasContainer">                           
                          <canvas id="canvas" class="canvas" width="auto" height="226" style="border: none;"></canvas>
                        </div>
                    </div>
                    <div class="controls">
                        <!--색상 버튼-->
                        <div class="color-palette">
                            <input id="color" type="color" class="dp_n"/>
                            <div class="controls__colors color-items" id="jsColors">
                                <div class="controls__color color-option color-red" ><img src="../../COMM/IMG/CRAYON_BV.PNG" data-color="#ff0000" alt="랜덤" /></div>
                                <div class="controls__color color-option color-red" ><img src="../../COMM/IMG/CRAYON_RD.PNG" data-color="#ff0000" alt="빨강" /></div>
                                <div class="controls__color color-option color-orange" ><img src="../../COMM/IMG/CRAYON_OR.png" data-color="#ff8c00" alt="주황" /></div>
                                <div class="controls__color color-option color-yellow" ><img src="../../COMM/IMG/CRAYON_YL.png" data-color="#ffff00" alt="노랑" /></div>
                                <div class="controls__color color-option color-green" ><img src="../../COMM/IMG/CRAYON_GN.png" data-color="#008000" alt="초록" /></div>
                                <div class="controls__color color-option color-blue" ><img src="../../COMM/IMG/CRAYON_BL.PNG" data-color="#0000ff" alt="파랑" /></div>
                                <div class="controls__color color-option color-purple" ><img src="../../COMM/IMG/CRAYON_PR.png" data-color="#800080" alt="보라" /></div>
                            </div> 

                            <!-- 뒤로 돌리기 버튼 -->
                            <div id="undo" class="bin-btn"></div>
                        </div>
                    </div>
                    <button class="next-btn"></button>
                </section>
                <!-- //section1 -->
                
                <section class="section section2">
                    <div class="pageContents">
                        <div class="stick-panel on">
                            <div class="answer answer11" data-answer=00><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_1.png" class="droppableImg"/></div>
                            <div class="answer answer12" data-answer=01><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_2.png" class="droppableImg"/></div>
                            <div class="answer answer13" data-answer=02><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_3.png" class="droppableImg"/></div>
                            <div class="answer answer14" data-answer=03><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_4.png" class="droppableImg"/></div>
                            <div class="item-img"><img src="../../../COMM/IMG/WORD/1_1/ITEM_1_1.PNG" alt=""></div>
                            <div class="item-word"><img src="../../../COMM/IMG/WORD/1_1/WORD_1_1_3.PNG" alt=""></div>   
                        </div>
                        <div id="wordWrap" class="answer-list"></div>
                    </div> 
                </section>
                <!-- //section2 -->

                <!-- <section class="section section3">
                    <div class="pageContents">
                        <div class="stick-panel">
                            <div class="answer answer11" data-answer=00><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_1.png"/></div>
                            <div class="answer answer12" data-answer=01><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_2.png"/></div>
                            <div class="answer answer13" data-answer=02><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_3.png"/></div>
                            <div class="answer answer14" data-answer=03><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_4.png"/></div>
                            <div class="item-img"><img src="../../../COMM/IMG/WORD/1_1/ITEM_1_1.PNG" alt=""></div>
                            <div class="item-word"><img src="../../../COMM/IMG/WORD/1_1/WORD_1_1_3.PNG" alt=""></div>
                        </div>
                        <div class="stick-panel">
                            <div class="answer answer11" data-answer=00><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_1.png"/></div>
                            <div class="answer answer12" data-answer=01><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_2.png"/></div>
                            <div class="answer answer13" data-answer=02><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_3.png"/></div>
                            <div class="answer answer14" data-answer=03><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_4.png"/></div>
                            <div class="item-img"><img src="../../../COMM/IMG/WORD/1_1/ITEM_1_1.PNG" alt=""></div>
                            <div class="item-word"><img src="../../../COMM/IMG/WORD/1_1/WORD_1_1_3.PNG" alt=""></div>
                        </div>
                        <div class="stick-panel">
                            <div class="answer answer11" data-answer=00><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_1.png"/></div>
                            <div class="answer answer12" data-answer=01><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_2.png"/></div>
                            <div class="answer answer13" data-answer=02><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_3.png"/></div>
                            <div class="answer answer14" data-answer=03><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_4.png"/></div>
                            <div class="item-img"><img src="../../../COMM/IMG/WORD/1_1/ITEM_1_1.PNG" alt=""></div>
                            <div class="item-word"><img src="../../../COMM/IMG/WORD/1_1/WORD_1_1_3.PNG" alt=""></div>
                        </div>
                        <div class="stick-panel">
                            <div class="answer answer11" data-answer=00><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_1.png"/></div>
                            <div class="answer answer12" data-answer=01><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_2.png"/></div>
                            <div class="answer answer13" data-answer=02><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_3.png"/></div>
                            <div class="answer answer14" data-answer=03><img src="../../COMM/IMG/WORD/1_1/STICKER_ON_1_4.png"/></div>
                            <div class="item-img"><img src="../../../COMM/IMG/WORD/1_1/ITEM_1_1.PNG" alt=""></div>
                            <div class="item-word"><img src="../../../COMM/IMG/WORD/1_1/WORD_1_1_3.PNG" alt=""></div>
                        </div>
                    </div>
                    <button class="done-btn">
                        <img src="../../../COMM/IMG/BTN_DONE.PNG" alt=""> 
                    </button>
                </section> -->
                <!-- //section3 -->
            </div>

            <div class="inner inner2">
              <section class="section section1">
                <div class="pageContents">
                    <div class="item-img"><img src="../../COMM/IMG/WORD/1_1/ITEM_1_1.png"/></div>
                    <div id="canvasContainer">                           
                      <canvas id="canvas" class="canvas" width="auto" height="226" style="border: none;"></canvas>
                    </div>
                </div>
                <div class="controls">
                    <!--색상 버튼-->
                    <div class="color-palette">
                        <input id="color" type="color" class="dp_n"/>
                        <div class="controls__colors color-items" id="jsColors">
                            <div class="controls__color color-option color-red" ><img src="../../COMM/IMG/CRAYON_BV.PNG" data-color="#ff0000" alt="랜덤" /></div>
                            <div class="controls__color color-option color-red" ><img src="../../COMM/IMG/CRAYON_RD.PNG" data-color="#ff0000" alt="빨강" /></div>
                            <div class="controls__color color-option color-orange" ><img src="../../COMM/IMG/CRAYON_OR.png" data-color="#ff8c00" alt="주황" /></div>
                            <div class="controls__color color-option color-yellow" ><img src="../../COMM/IMG/CRAYON_YL.png" data-color="#ffff00" alt="노랑" /></div>
                            <div class="controls__color color-option color-green" ><img src="../../COMM/IMG/CRAYON_GN.png" data-color="#008000" alt="초록" /></div>
                            <div class="controls__color color-option color-blue" ><img src="../../COMM/IMG/CRAYON_BL.PNG" data-color="#0000ff" alt="파랑" /></div>
                            <div class="controls__color color-option color-purple" ><img src="../../COMM/IMG/CRAYON_PR.png" data-color="#800080" alt="보라" /></div>
                        </div> 

                        <!-- 뒤로 돌리기 버튼 -->
                        <div id="undo" class="bin-btn"></div>
                    </div>
                </div>
                <button class="next-btn"></button>
              </section>
              <!-- //section1 -->
              
              <section class="section section2">
                  <div class="pageContents">
                      <div class="stick-panel on">
                          <div class="answer answer11" data-answer=00><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_1.png" class="droppableImg"/></div>
                          <div class="answer answer12" data-answer=01><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_2.png" class="droppableImg"/></div>
                          <div class="answer answer13" data-answer=02><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_3.png" class="droppableImg"/></div>
                          <div class="answer answer14" data-answer=03><img src="../../COMM/IMG/WORD/1_1/STICKER_OFF_1_4.png" class="droppableImg"/></div>
                          <div class="item-img"><img src="../../../COMM/IMG/WORD/1_1/ITEM_1_1.PNG" alt=""></div>
                          <div class="item-word"><img src="../../../COMM/IMG/WORD/1_1/WORD_1_1_3.PNG" alt=""></div>   
                      </div>
                      <div id="wordWrap" class="answer-list"></div>
                  </div> 
              </section>
              <!-- //section2 -->
            </div>
            <div class="inner inner3">
              <!-- 반복 - 기린 -->
            </div>
            <div class="inner inner4">
              <!-- 반복 - 원숭이 -->
            </div>
        </div>

      <div class="confetti-wrap">
          <img src="../../COMM/IMG/BG_CONFETTI.PNG" class="deco-img" alt="데코 이미지">
      </div>
    </div>
    <!-- wrap -->

<SCRIPT SRC="../../../COMM/JS/JQUERY-3.5.1.MIN.JS"></SCRIPT>
<SCRIPT SRC="../../../COMM/JS/JQUERY-UI.MIN.JS"></SCRIPT>
<SCRIPT SRC="../../../COMM/JS/COMMON.JS"></SCRIPT>
<SCRIPT SRC="../../../COMM/JS/TOUCH.JS"></SCRIPT>
<SCRIPT SRC="../../../COMM/JS/FABRIC_S.JS"></SCRIPT>
<SCRIPT SRC="../../../COMM/JS/DATA.JSON"></SCRIPT>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
<script>
  const words = [
      [ '../../../COMM/IMG/WORD/1_1/STICKER_ON_1_1.PNG', 
        '../../../COMM/IMG/WORD/1_1/STICKER_ON_1_2.PNG', 
        '../../../COMM/IMG/WORD/1_1/STICKER_ON_1_3.PNG',
        '../../../COMM/IMG/WORD/1_1/STICKER_ON_1_4.PNG',
      ],
      // ['영향', '먹고 먹히는', '먹이 사슬'],
      // ['생태계 평형', '깨어지기', '회복'],
      // ['적응', '겨울잠', '환경'],
  ]; //단어들 정답 순서대로 작성

  
</script>
<style>
.answer11 {
  width: 10.4%;
  height: 24.5%;
  left: 12%;
  top: 15%;
}

.answer12 {
  width: 12.6%;
  height: 17%;
  right: 12%;
  top: 18%;
}
.answer13 {
  width: 16%;
  height: 21%;
  left: 8%;
  bottom: 23%;
}

.answer14 {
  width: 9.4%;
  height: 20%;
  right: 12%;
  bottom: 23%;
}
</style>
<script>
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // 시작 세팅

    // const word = "1_1";
    // let mydata = JSON.parse(JSON.stringify(data));
    // let wordData = mydata[word];
    // let wordUrl = wordData.url;
    // let _fabricConfig = {
    //     // ....
    //     crossOrigin:'anonymous'
    // };
    
    // let canvas = this.__canvas = new fabric.Canvas('canvas',_fabricConfig);  
</script>
<script>
  const canvas = new fabric.Canvas('canvas');
  // const canvas2 = new fabric.Canvas('canvas2');
  //  context = canvas.getContext("2d");

  // canvas.selection = false;

  const image = new fabric.Image();

  image.setSrc('../../COMM/IMG/WORD/1_1/WORD_1_1_3.PNG', () => {
    canvas.setDimensions({
      width: image.width,
      height: image.height,
      selectable: false,
    });

    canvas.add(image);
    canvas.isDrawingMode = true;
    canvas.freeDrawingBrush.color = 'black';
    canvas.freeDrawingBrush.width = 10;
    canvas.clipPath = new fabric.Rect({
      left: 0,
      top: 0,
      width: image.width,
      height: image.height,
      absolutePositioned: true,
    });
  });

  // 캔버스 크기를 이미지와 동일하게 설정
  // canvas.width = image.width;
  // canvas.height = image.height;

  // console.log(canvas.width + ',' + image.width)

  // canvas.on('path:created', function (options) {
  //   const path = options.path;
  //   if (!canvas.clipPath.containsPoint(path.getPointByOrigin('center', 'center'))) {
  //     canvas.remove(path);
  //   }
  // });

</script>
<script>
  // 색상 선택 시작
  const colorOption = Array.from(document.getElementsByClassName("color-option"));
  const color = document.querySelector("#color");

  function oncolorChange(event) {
    $(this).addClass('active');
    $(this).siblings().removeClass('active');
    const colorValue = event.target.dataset.color;
    console.log(event.target)
    canvas.strokeStyle = colorValue; /** 선 색상변경 */
    canvas.fillStyle = colorValue;
    color.value = colorValue; /** 변경된 색상 표시 */
    canvas.freeDrawingBrush.color = color.value;
  }
  // color.addEventListener("change", oncolorChange); /** 색상변경 함수명 */
  colorOption.forEach((color) => color.addEventListener("click", oncolorChange));
  // //색상 선택 끝
</script>
<script>
  // 뒤로 돌리기 기능 시작
  let lockHistory = false; //Undo/Redo
  const undo_history = [];
  const redo_history = [];

  const binBtn = document.querySelector(".bin-btn"); // 휴지통 아이콘
  const nextBtn = document.querySelector(".next-btn"); // 다음으로 가기 버튼

  // var canvas = new fabric.Canvas("canvas");

  canvas.isDrawingMode = true;
  canvas.freeDrawingBrush.width = 20;

  undo_history.push(JSON.stringify(canvas));

  canvas.on("object:added", function () {
    if (lockHistory) return;
    console.log("object:added");
    binBtn.classList.add('active');
    nextBtn.classList.add('active');
    undo_history.push(JSON.stringify(canvas));
    redo_history.length = 0;
    console.log(undo_history.length);
  });

  // canvas.on("object:modified", function () {
  //   if (lockHistory) return;
  //   console.log("object:modified");
  //   undo_history.push(JSON.stringify(canvas));
  //   redo_history.length = 0;
  //   console.log(undo_history.length);
  // });

  function undo() {
    if (undo_history.length > 0) {
      lockHistory = true;
      if (undo_history.length > 1) redo_history.push(undo_history.pop());
      const content = undo_history[undo_history.length - 1];
      canvas.loadFromJSON(content, function () {
        canvas.renderAll();
        lockHistory = false;
        console.log(undo_history.length)
      });
      if (undo_history.length == 1) {
        binBtn.classList.remove("active");
      }
    }
  }

  document.getElementById("undo").addEventListener("click", undo);

  function deleteSelectedObjects() {
    lockHistory = true;
    canvas.getActiveObjects().forEach((element) => {
      canvas.remove(element);
    });
    canvas.discardActiveObject();
    canvas.requestRenderAll();
    undo_history.push(JSON.stringify(canvas)); //UNDO
    lockHistory = false;
  }

  //Detele
  document.addEventListener("keyup", function (e) {
    console.log(e.keyCode);
    if ((e.keyCode == 8) | (e.keyCode == 46)) {
      deleteSelectedObjects();
    }
  });
  // //뒤로 돌리기 기능 끝
</script>
</body>

</html>